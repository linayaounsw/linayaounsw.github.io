<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>InsData</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- CSS
    ================================================== -->
    <link href='http://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/bootstrap-responsive.css">
    <link rel="stylesheet" href="css/jquery.lightbox-0.5.css">
    <link rel="stylesheet" href="css/custom-styles.css">

    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <link rel="stylesheet" href="css/style-ie.css"/>
    <![endif]-->

    <!-- Favicons
    ================================================== -->
    <link rel="shortcut icon" href="img/our.ico">
    <link rel="apple-touch-icon" href="img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="img/apple-touch-icon-114x114.png">

    <!-- JS
    ================================================== -->
    <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/jquery.custom.js"></script>


</head>
<body class="home">
<!-- Color Bars (above header)-->
<div class="color-bar-1"></div>
<div class="color-bar-2 color-bg"></div>

<div class="container">

    <div class="row header"><!-- Begin Header -->

        <!-- Logo
        ================================================== -->
        <div class="span5 logo">
            <a href="index.htm"><img src="img/Group websites/logo.png" style="height: 80px;" alt="" /></a>
            <h5>Inspiration of Data</h5>
        </div>

        <!-- Main Navigation
        ================================================== -->
        <div class="span7 navigation">
            <div class="navbar hidden-phone">
                <ul class="nav">
                    <li><a href="index.htm">Home</a></li>
                    <li><a href="People.htm">People</a></li>
                    <li><a href="Publication.htm">Publication</a></li>
                    <li><a href="Opensource.htm">Opensource</a></li>
                    <li><a href="Groupwiki.htm">Groupwiki</a></li>
                    <li><a href="Calendar.htm">Calendar</a></li>
                </ul>

            </div>

            <!-- Mobile Nav
            ================================================== -->
            <form action="#" id="mobile-nav" class="visible-phone">
                <div class="mobile-nav-select">
                    <select onchange="window.open(this.options[this.selectedIndex].value,'_top')">
                        <option value="">Navigate...</option>
                        <option value="index.htm">Home</option>
                        <!--<option value="index.htm">- Full Page</option>
                        <option value="index-gallery.htm">- Gallery Only</option>
                        <option value="index-slider.htm">- Slider Only</option> -->
                        <option value="People.htm">People</option>
                        <option value="Publication.htm">Publication</option>
                        <!--<option value="page-full-width.htm">- Full Width</option>
                        <option value="page-right-sidebar.htm">- Right Sidebar</option>
                        <option value="page-left-sidebar.htm">- Left Sidebar</option>
                        <option value="page-double-sidebar.htm">- Double Sidebar</option>-->
                        <option value="Opensource.htm">Opensource</option>
                        <!--<option value="gallery-3col.htm">- 3 Column</option>
                        <option value="gallery-4col.htm">- 4 Column</option>
                        <option value="gallery-6col.htm">- 6 Column</option>
                        <option value="gallery-4col-circle.htm">- Gallery 4 Col Round</option>
                        <option value="gallery-single.htm">- Gallery Single</option> -->
                        <option value="Groupwiki.htm">Groupwiki</option>
                        <!--<option value="blog-style1.htm">- Blog Style 1</option>
                        <option value="blog-style2.htm">- Blog Style 2</option>
                        <option value="blog-style3.htm">- Blog Style 3</option>
                        <option value="blog-style4.htm">- Blog Style 4</option>
                        <option value="blog-single.htm">- Blog Single</option>-->
                        <option value="Calendar.htm">Calendar</option>
                    </select>
                </div>
            </form>

        </div>

    </div><!-- End Header -->

    <!-- Page Content
    ================================================== -->
    <!-- Blog Content
     ================================================== -->
    <div class="row"><!--Container row-->

        <!-- Blog Full Post
        ================================================== -->
        <div class="span8 blog">

            <article>
                <h3 class="title-bg"><a href="#">Wiki of DrStrange: Group GPU Accelerated Computing Server</a></h3>
                <div class="post-content">
                    <div class="post-body">
                        <p>Welcome to Wiki for <b>DrStrange</b>, the GPU accelerated computing server in the
                            <a href="http://www.cse.unsw.edu.au">School of Computer Science and Engineering</a> at the
                            <a href="http://www.unsw.edu.au">University of New South Wales</a>.
                            This page should include all basic things about the machine, and more are to be added.
                        </p>

                        <b>Contents</b>
                        <ol>
                            <li><a href="#overview">Overview</a></li>
                            <li><a href="#start">Getting Started</a></li>
                            <ol>
                                <li><a href="#access">Accesing the Server</a></li>
                                <ol>
                                    <li><a href="#ssh_key_gen">Generating SSH Key Pair</a></li>
                                    <li><a href="#ssh_login">Login</a></li>
                                </ol>

                                <li><a href="#start_comp">Starting Computing</a></li>
                                <ol>
                                    <li><a href="#screen">GNU Screen</a></li>
                                    <li><a href="#gpustat">Checking GPU Status</a></li>
                                    <li><a href="#gpumask">Masking GPUs</a></li>
                                    <li><a href="#tf_mem_growth">TensorFLow: Allowing GPU Memory Growth</a></li>
                                </ol>
                            </ol>
                        </ol>

                        <h4 id="overview">Overview</h4>
                        <p>DrStrange is a midrange system/ minicomputer customized and purchased for the purpose of
                            conducting massive computing tasks for our own group, specifically floating point
                            computation intensive deep learning tasks. It currently consists of 2 12-core/ 24-thread
                            Intel(R) Xeon(R) CPU E5-2697 v2 CPUs, 6 NVIDIA TITAN X Pascal GPUs, a total 768 GiB memory,
                            and an Intel P3608 SSD( 1.6TB, NVMe PCIe 3.0 X8 HET MLC) with
                            7 Seagate Enterprise Capacity 2.5 HDDs(2TB SATA 6Gb/s 7200rpm 128MB). DrStrange runs
                            standard CentOS 7.
                        </p>
                        <p>
                            <b>Global Available software</b>:<br>
                            GNU GCC 4.8.5 <br>
                            Python 2.7/3.6 with Numpy 1.12.1 , pandas 0.20.1 , tensorflow-gpu 1.0.1 , scikit-tensor 0.1 ,
                            scipy 0.19.0<br>
                            openjdk 1.8.0_131
                        </p>




                        <h4 id="start">Getting Started</h4>
                        <h5 id="access">Accessing the Server</h5>
                        <p>DrStrange runs linux, the server can be accessed using
                            <a href="https://www.ssh.com/">SSH</a>, thus SSH client is required. Unix based systems,
                            such as MacOS(Mac OS X), OpenBSD and most Linux distributions, usually already have OpenSSH
                            client included out of box. However, installation of one of such client on Microsoft Windows
                            systems is compulsory. SSH client can be found by your preference, yet here in this Wiki,
                            PuTTY is chosen for demonstration.
                        </p>
                        <p>
                            <b>Note:</b> Password authentication for SSH is disabled due to security reasons. Public key
                            for SSH is required to be sent to one of the administrators, by the time of account creation,
                            change of private key, or requesting authentication of new hosts( Copying private key file to
                            new hosts is also feasible to enable authentication, but not recommended).<br>
                            <a href="#ssh_key_gen"><b>Generate a key for SSH</b></a>
                        </p>

                        <b id="ssh_key_gen">Generating SSH Key Pair</b>
                        <p>If you don't have a key pair for SSH yet, please following the instructions to generate the
                            key pair. Otherwise, you can jump to <a href="#ssh_login"><b>Login</a></b> section.
                        </p>
                        <p>Unix based systems aformentioned often have OpenSSH client bultin, which also ususally
                            shipped with key generators, and its binary excutable is typically called `ssh-keygen`.
                            A simple exmaple of usage can be as following:
                        </p>
                        <pre class="well">
$ ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/home/USERNAME/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/USERNAME/.ssh/id_rsa.
Your public key has been saved in /home/USERNAME/.ssh/id_rsa.pub.
The key fingerprint is:
00:50:7f:29:e2:2c:37:af:b2:8f:cf:e4:50:2f:c8:82 USERNAME@YOURCOMPUTER
The key's randomart image is:
+--[ RSA 2048]----+
|  .oo            |
|     o   .       |
|    . + o        |
|   o . +         |
|  . *   S        |
|.. = +           |
|E + o o          |
| ..* o           |
|  o=*            |
+-----------------+
                        </pre>
                        <p>
                            Tutorial for "KEY GENERATOR FOR PUTTY ON WINDOWS" can be found
                            <a href="https://www.ssh.com/ssh/putty/windows/puttygen" target="_blank">here</a>.
                        </p>

                        <b id="ssh_login">Login</b>
                        <p>This section is for ones not familar or have little with Linux systems. Experienced users
                        can skip by clicking <a href="#start_comp">here</a> to start computing.
                        </p>
                        <pre class="well">
$ ssh USERNAME@drstrange.cse.unsw.edu.au
                        </pre>
                        <p>As our server is authenticated by SSH keys, you would now logged in, and get
                            the message below:
                        <p/>
                        <pre class="well">
		You are accesing a computer owned by:

	            Service Oriented Computing Group,
		    School of Computer Science and Engineering,
		    UNSW Sydney

	    ***** This service is for authorised clients only *****

 ****************************************************************************
 *                                                                          *
 * WARNING:     It is a criminal offence to:                                *
 *                                                                          *
 *              i.  Obtain access to data without permission                *
 *                        (Penalty 2 years imprisonment)                    *
 *              ii. Damage, delete, alter or insert data without permission *
 *                        (Penalty 10 years imprisonment)                   *
 *                                                                          *
 ****************************************************************************
Last login: Tue Jul  4 15:56:25 2017 from WHO.KNOW.THIS.COMPUTER
                        </pre>
                        <p>Tutorial for "How To Use SSH Keys with PuTTY (Windows users)" can be found
                            <a href="https://www.digitalocean.com/community/tutorials/how-to-use-ssh-keys-with-putty-on-digitalocean-droplets-windows-users"
                               target="_blank">
                                here
                            </a>.
                        </p>



                        <h5 id="start_comp">Starting Computing</h5>
                        <p>As the server is accessed via network, and connection outside CSE building can be unstable,
                        let me first introduce you <a href="https://www.gnu.org/software/screen/">GNU Screen</a>.
                        </p>
                        <b id="screen">GNU Screen</b>
                        <p> Screen is
                            a full-screen window manager that multiplexes a physical terminal between several processes,
                            typically interactive shells. Thus using Screen can help your remote processes survive a
                            network disruption. Screen is installed on Drstrange, and you can simply fork screen by

                        <pre>$ screen</pre>
                        a new shell ocuping the whole terminal window should appear, and don't panic, this is a new
                        instance of shell forked by Screen, your jobs before is not killed and still running. In this
                        Screen-forked shell you can do things as ususal.<br>
                        The magic here is you can detach a Screen, and later reattach it. By default, a Screen
                        session can be deattached by key combination <b>`Ctrl-a`</b> followed by <b>`d`</b>.<br>
                        To show a list of Screens invoked,
                        <pre>$ screen -ls</pre>
                        and it will give you an output similar to this:
                        <pre>
$screen -ls
There is a screen on:
	11123.pts-1.drstrange	(Detached)
1 Socket in /var/run/screen/S-USERNAME.
                        </pre>
                        In this example 11123 is the pid(Process ID) of the detached Screen, which can be reattached by
                        <pre>$ screen -r 11123</pre>
                        and screen with pid 11123 will be reattached, and display as full terminal windows size.
                        </p>
                        <b id="gpustat">Checking GPU Status</b>
                        <p>It is generally recommended to check GPU status before running a gpu accelarated program, so
                            that we can avoid interrupting jobs owned by someone else. Also you may not want to fork your
                            job on a busy GPU unit. Check GPU status typically can be done by command <b>`nvidia-smi`</b>.
                            While here in our machine, a more user friendly python script is configured and of which the
                            usage is encouraged.<br>
                            You can check the usage by<pre>$gpustat -cpu</pre>
                        which will give you <b>GPU number, GPU name, temprature, GPU ultilization rate, memory usage,
                        user, process name</b> accordingly in different colors.
                        </p>
                        <b id="gpumask">Masking GPUs</b>
                        <p>Some GPU programs are designed to utilize multiple GPUs, and this can largely save time
                            consumed on trainning massive models. Somehow this often preventing other users from
                            conducting experiments, especially TensorFlow based ones, which are by default allocating
                            all available memory at start. As our machine have 6 NVIDIA Titan X pascal GPUs, which is
                            quite powerful, using all 6 GPUs at once is often over-kill. To avoid such situation, a mask
                            can be introduced: <b>`CUDA_VISIBLE_DEVICES`</b>.<br>
                            `CUDA_VISIBLE_DEVICES` is an environment variable, which can be simply added in frot of
                            linux commands at each run. Syntax can be:
                            <pre>
CUDA_VISIBLE_DEVICES=1      //Only device 1 will be seen
CUDA_VISIBLE_DEVICES=0,1    //Devices 0 and 1 will be visible
CUDA_VISIBLE_DEVICES=”0,1”  //Same as above, quotation marks are optional
CUDA_VISIBLE_DEVICES=0,2,3  //Devices 0, 2, 3 will be visible; device 1, 4, 5 is masked
                             </pre>
                        For example, you have a python script call <b>`eg.py`</b>, which you want spawn it only on
                        <b>`GPU device 0`</b>, this can be done via:
                        <pre>$ CUDA_VISIBLE_DEVICES=0 python eg.py</pre>
                        </p>
                        <b id="tf_mem_growth">TensorFLow: Allowing GPU Memory Growth</b>
                        <p>Since Tensorflow is considerably popular in our group and many have not programed properly with it
                            so far, I feel necessary to propose another handy way to use GPU resource more efficiently,
                            that is to control the usage of memory, to only grow the memory usage as is needed by the process.
                            This can be done by set parameter <b>`allow_growth`</b> to be <b>`True`</b> when starting the
                            session.
                        <pre>
config = tf.ConfigProto()
config.gpu_options.allow_growth = True
session = tf.Session(config=config, ...)
                        </pre>
                        Also, a <b>`per_process_gpu_memory_fraction`</b> option setting up limit of memory usage of process
                        is also quite handy, especially used along with <b>`CUDA_VISIBLE_DEVICES`</b>. An example to only
                        allocate 40% of the total memory of each GPU can be:
                        <pre>
config = tf.ConfigProto()
config.gpu_options.per_process_gpu_memory_fraction = 0.4
session = tf.Session(config=config, ...)
                    </pre>

                        More details are available
                        <a href="https://www.tensorflow.org/tutorials/using_gpu#allowing_gpu_memory_growth" target="_blank">
                            here
                        </a>.
                    </div>

                    </p>

                    <div class="post-summary-footer">
                        <ul class="post-data">
                            <li><i class="icon-calendar"></i> 03/07/17</li>
                            <li><i class="icon-user"></i> <a href="#">Chaoran Huang</a></li>
                            <li><i class="icon-tags"></i> <a href="#">GPU</a>, <a href="#">Server</a></li>
                        </ul>
                    </div>
                </div>
            </article>

            <!-- About the Author -->
            <section class="post-content">
                <div class="post-body about-author">
                    <img src="img/Group websites/chaoran.jpg" alt="author" style="height: 80px;">
                    <h4>About Chaoran Huang</h4>
                    Chaoran Huang is a PhD candidate in our group, and he manages the GPU server. More details are
                    available at <a href="http://www.cse.unsw.edu.au/~chaoranh/">his personal webpage</a>.
                </div>
            </section>

        </div><!--Close container row-->

        <!-- Blog Sidebar
        ================================================== -->
        <div class="span4 sidebar page-sidebar">


            <!--Popular Posts-->
            <h5 class="title-bg">Popular Posts</h5>
            <ul class="popular-posts">
                <li>
                    <a href="#"><img src="img/gallery/gallery-img-2-thumb.jpg" alt="Popular Post"></a>
                    <h6><a href="#">Lorem ipsum dolor sit amet consectetur adipiscing elit</a></h6>
                    <em>Posted on 09/01/15</em>
                </li>
                <li>
                    <a href="#"><img src="img/gallery/gallery-img-2-thumb.jpg" alt="Popular Post"></a>
                    <h6><a href="#">Nulla iaculis mattis lorem, quis gravida nunc iaculis</a></h6>
                    <em>Posted on 09/01/15</em>
                <li>
                    <a href="#"><img src="img/gallery/gallery-img-2-thumb.jpg" alt="Popular Post"></a>
                    <h6><a href="#">Vivamus tincidunt sem eu magna varius elementum maecenas felis</a></h6>
                    <em>Posted on 09/01/15</em>
                </li>
            </ul>

            <!--Tabbed Content-->
        </div>

    </div>

</div> <!-- End Container -->

<!-- Footer Area
    ================================================== -->

<div class="footer-container"><!-- Begin Footer -->
    <div class="container">
        <div class="row footer-row">
            <div class="span3 footer-col">
                <h5>Visit</h5>
                <address>
                    CSE Building, UNSW Sydney<br />
                    NSW 2052, Australia<br />
                </address>
                <!--<ul class="social-icons">
                    <li><a href="#" class="social-icon facebook"></a></li>
                    <li><a href="#" class="social-icon twitter"></a></li>
                    <li><a href="#" class="social-icon dribble"></a></li>
                    <li><a href="#" class="social-icon rss"></a></li>
                    <li><a href="#" class="social-icon forrst"></a></li>
                </ul> -->
            </div>
            <div class="span3 footer-col">
                <h5>Call</h5>
                <p>+61 2 9385 6556</p>
            </div>
            <div class="span3 footer-col">
                <h5>Contact</h5>
                <p>lina.yao@unsw.edu.au</p>
            </div>
            <div class="span3 footer-col">
                <h5>Copyright</h5>
                <p>2012 Piccolo Theme. All rights reserved.</p>
            </div>
        </div>


    </div>
</div><!-- End Footer -->

<!-- Scroll to Top -->
<div id="toTop" class="hidden-phone hidden-tablet">Back to Top</div>

</body>
</html>
